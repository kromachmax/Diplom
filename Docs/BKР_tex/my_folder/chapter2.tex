\chapter{Разработка модифицированного аукционного алгоритма}
\label{ch2}

В данной главе представлена разработка модифицированного аукционного алгоритма для распределенных систем роботов с ограниченными областями связи. На основе анализа аукционного алгоритма Бертсекаса \cite{bertsekas1990} предлагается модификация, учитывающая топологические ограничения сети, при которых роботы обмениваются информацией только с соседями, объединенными в группы на основе радиуса связи. Описывается математическая модель задачи, а также алгоритмические изменения, обеспечивающие независимую обработку связных компонент и устойчивость к отсутствию коммуникации между группами. Формулируются теоремы об эффективности и близости решения к оптимальному.

\section{Математическая модель задачи}

Задача назначения формулируется следующим образом. Дано множество из \( n \) роботов \( R = \{r_1, r_2, \ldots, r_n\} \) и множество из \( m \) целей \( T = \{t_1, t_2, \ldots, t_m\} \). Каждый робот \( r_i \) имеет координаты \( p_i = (x_i, y_i) \), а каждая цель \( t_j \) --- координаты \( q_j = (X_j, Y_j) \). Затраты на назначение робота \( r_i \) цели \( t_j \) заданы матрицей \( \{c_{ij}\} \), где \( c_{ij} \) представляет время, необходимое роботу \( i \) для достижения цели \( j \), вычисляемое по формуле:

\[
c_{ij} = \frac{d(p_i, q_j)}{v_i},
\]

\noindent где \( d(p_i, q_j) = \sqrt{(X_j - x_i)^2 + (Y_j - y_i)^2} \) --- евклидово расстояние, \( v_i \) --- скорость робота \( i \), предполагаемая постоянной и одинаковой для всех роботов (например, \( v_i = 1 \)). Для решения задачи в терминах максимизации матрица затрат \( c_{ij} \) преобразуется в матрицу выгод \( \alpha_{ij} \):

\[
\alpha_{ij} = C_{\text{max}} - c_{ij}, \quad \text{где} \quad C_{\text{max}} = \max_{i,j} c_{ij}.
\]

Все роботы имеют доступ ко всем целям, поэтому \( c_{ij} \) и \( \alpha_{ij} \) определены для любых \( i \) и \( j \).

Матрица связи роботов \( V = \{v_{ij}\} \) определяет топологию сети: \( v_{ij} = 1 \), если \( d(p_i, p_j) \leq R \) (роботы \( r_i \) и \( r_j \) могут обмениваться информацией), и \( v_{ij} = 0 \) в противном случае. Роботы объединяются в группы (связные компоненты графа \( V \)), внутри которых проводится аукцион.

Цель задачи --- максимизировать суммарную выгоду:

\[
\sum_{i=1}^n \alpha_{i j_i} \to \max,
\]

где \( j_i \) --- цель, назначенная роботу \( r_i \), что эквивалентно минимизации суммарного времени:

\[
\sum_{i=1}^n c_{i j_i} \to \min,
\]

поскольку \( \sum_{i=1}^n \alpha_{i j_i} = \sum_{i=1}^n (C_{\text{max}} - c_{i j_i}) = n C_{\text{max}} - \sum_{i=1}^n c_{i j_i} \), и максимизация \( \sum \alpha_{i j_i} \) соответствует минимизации \( \sum c_{i j_i} \). Условия задачи:

\begin{itemize}
    \item Цель может быть назначена нескольким роботам в процессе аукциона, но в итоговом решении для каждой цели \( t_j \) учитывается только робот с максимальной выгодой \( \alpha_{ij} \), что эквивалентно минимальному времени \( c_{ij} \). Остальные назначения для этой цели отбрасываются.
    \item Роботы обмениваются информацией о ценах и назначениях только внутри связных компонент графа связи \( V \).
\end{itemize}

\section{Модификация аукционного алгоритма}

Модифицированный аукционный алгоритм адаптирует подход Бертсекаса \cite{bertsekas1990} для учета отсутствия коммуникации между роботами. Ключевые изменения включают:

\begin{itemize}
    \item Полная видимость целей: Все цели доступны каждому роботу, поэтому \( c_{ij} \) и \( \alpha_{ij} \) определены для всех \( i, j \).
    \item Разделение на связные компоненты: Роботы группируются по графу связи \( V \), что позволяет проводить аукцион независимо для каждой связанной компоненты.
    \item Независимая обработка компонент: Каждая связная компонента обрабатывается отдельно, моделируя распределенную систему без коммуникации между группами.
    \item Разрешение конфликтов: Если несколько роботов из разных компонент выбирают одну цель, учитывается только робот с максимальной выгодой \( \alpha_{ij} \), что соответствует минимальному времени \( c_{ij} \), а остальные назначения отбрасываются.
\end{itemize}

\subsection{Описание алгоритма}

Алгоритм состоит из следующих шагов:

\begin{enumerate}
    \item \textbf{Разбиение на компоненты}:
    \begin{itemize}
        \item Каждый робот \( r_i \) определяет своих соседей, с которыми он может обмениваться информацией: \( v_{ik} = 1 \), если \( d(p_i, p_k) \leq R \), и \( v_{ik} = 0 \) иначе. Эта информация хранится локально.
        \item Каждый робот \( r_i \) участвует в распределённом обмене информацией со своими соседями (где \( v_{ik} = 1 \)), отправляя свой идентификатор и получая идентификаторы соседей. Этот процесс повторяется, пока роботы не определят состав своей связной компоненты \( C_l \).
        \item В результате каждый робот знает, к какой компоненте \( C_l \) он принадлежит, и список роботов в этой компоненте.
    \end{itemize}
    \item \textbf{Инициализация}:
    \begin{itemize}
        \item Каждый робот \( r_i \) знает свои координаты \( p_i = (x_i, y_i) \) и координаты всех целей \( \{q_j\} \). Робот вычисляет локальную строку матрицы затрат \( \{c_{ij}\} \), где \( c_{ij} = \frac{d(p_i, q_j)}{v_i}\).
        \item Через локальный обмен информацией с соседями (где \( v_{ik} = 1 \)) роботы в компоненте \( C_l \) совместно определяют \( C_{\text{max}} = \max_{i \in C_l, j} c_{ij} \).
        \item Каждый робот \( r_i \in C_l \) преобразует свою строку затрат в строку матрицы выгод: \( \alpha_{ij} = C_{\text{max}} - c_{ij} \).
        \item Каждый робот инициализирует цены целей \( \{p_j = 0\} \) и своё назначение \( j_i = -1 \) (не назначен).
    \end{itemize}
    \item \textbf{Аукцион в компонентах}:
    \begin{itemize}
        \item Для каждой компоненты \( C_l \):
        \begin{enumerate}
            \item Для каждого робота \( r_i \in C_l \) вычислить текущую прибыль: \( \alpha_{i j_i} - p_{j_i} \), если \( j_i \neq -1 \), иначе \( 0 \).
            \item Проверить условие почти счастья: \( \alpha_{i j_i} - p_{j_i} \geq \max_j \{\alpha_{ij} - p_j\} - \varepsilon \), где \( \varepsilon > 0 \).
            \item Если робот не почти счастлив, найти цель \( t_{j_i} \): \( j_i = \arg \max_j \{\alpha_{ij} - p_j\} \), включая фиктивную цель (\( \alpha_{i,-1} = 0 \)).
            \item Вычислить \( v_i = \max_j \{\alpha_{ij} - p_j\} \), \( w_i = \max_{j \neq j_i} \{\alpha_{ij} - p_j\} \).
            \item Если \( j_i = -1 \), переназначить робота на фиктивную цель без изменения цен.
            \item Иначе переназначить: робот \( r_i \) получает цель \( t_{j_i} \), прежний владелец \( t_{j_i} \) (если есть) становится неназначенным.
            \item Увеличить цену: \( p_{j_i} += v_i - w_i + \varepsilon \).
            \item Повторять, пока все роботы в \( C_l \) не станут почти счастливы.
        \end{enumerate}
    \end{itemize}
\end{enumerate}

\subsection{Сходимость алгоритма}

\begin{theorem}[Сходимость модифицированного аукционного алгоритма]
\label{thm:mod_auction_convergence}
Модифицированный аукционный алгоритм завершается за конечное число шагов, при котором все роботы в каждой связной компоненте удовлетворяют условию почти счастья, определенному в главе \ref{ch:analysis}.
\end{theorem}

\textbf{Доказательство}. 
Модифицированный алгоритм проводит аукцион в каждой связной компоненте \( C_l \), следуя шагам оригинального аукционного алгоритма, описанного в главе \ref{ch:analysis}. Согласно теореме \ref{thm:auction_convergence} (глава \ref{ch:analysis}), оригинальный аукционный алгоритм завершается за конечное число шагов, обеспечивая почти равновесие, при котором все назначенные роботы почти счастливы, то есть для каждого робота \( i \), назначенного цели \( j_i \), выполняется:
\[
\alpha_{i j_i} - p_{j_i} \geq \max_{j=1,\ldots,m} \{\alpha_{ij} - p_j\} - \varepsilon.
\]
Поскольку аукцион в каждой компоненте \( C_l \) идентичен оригинальному, сходимость внутри \( C_l \) гарантируется той же теоремой. Таким образом, алгоритм завершается за конечное число шагов, обеспечивая почти равновесие в каждой компоненте.

\subsection{Оценка итераций модифицированного аукционного алгоритма}

\begin{theorem}[Оценка числа итераций модифицированного аукционного алгоритма]
\label{thm:mod_auction_iterations}
Пусть \( k \) — число связных компонент графа связи \( V \), \( n_l \) — число роботов в компоненте \( C_l \), \( m \) — число целей, \( C = \max_{i,j} |a_{ij}| \) — максимальная абсолютная величина выгоды от назначения робота \( i \) на цель \( j \), а \( \varepsilon \) — минимальный шаг увеличения цены цели в алгоритме. Тогда общее число итераций модифицированного аукционного алгоритма в худшем случае не превышает \(m \cdot \sum_{l=1}^k \frac{C}{\varepsilon}\).
\end{theorem}

\begin{proof}
Для каждой связной компоненты \( C_l \) графа связи \( V \) применяется оригинальный аукционный алгоритм. Согласно теореме \ref{thm:auction_iterations}, число итераций для компоненты \( C_l \) в худшем случае не превышает \( \frac{m \cdot C}{\varepsilon} \). Суммируя по всем \( k \) компонентам, получаем общее число итераций: \(m \cdot \sum_{l=1}^k \frac{C}{\varepsilon}\).
\end{proof}
\subsection{Оптимальность}

\begin{theorem}[Оптимальность модифицированного алгоритма]
\label{thm:mod_auction_optimality}
В каждой связной компоненте \( C_l \) модифицированный аукционный алгоритм при целочисленных выгодах \( \alpha_{ij} \) и \( \varepsilon < 1/n \) дает оптимальное решение локальной задачи аукциона, как определено в главе \ref{ch:analysis}. Однако общее решение после объединения компонент не гарантирует глобальной оптимальности из-за отсутствия коммуникации между компонентами.
\end{theorem}

\textbf{Доказательство}. 
В каждой связной компоненте \( C_l \) аукцион проводится по правилам оригинального аукционного алгоритма, описанного в главе \ref{ch:analysis}. Согласно теореме \ref{thm:auction_optimality} (глава \ref{ch:analysis}), при целочисленных \( \alpha_{ij} \) и \( \varepsilon < 1/n \) оригинальный аукционный алгоритм обеспечивает оптимальное решение, где суммарная выгода \( \sum_{i \in C_l} \alpha_{i j_i} \) равна локальному оптимуму. Таким образом, в каждой компоненте \( C_l \) достигается оптимальное локальное назначение. 

Однако глобальная оптимальность не гарантируется. Из-за отсутствия коммуникации между компонентами роботы в \( C_l \) не учитывают выгоды роботов из других компонент, что может привести к выбору локально оптимальных, но глобально неоптимальных назначений. Следовательно, суммарная выгода \( \sum_{i=1}^n \alpha_{i j_i} \) может быть меньше глобального оптимума.


\section{Выводы}

Разработан модифицированный аукционный алгоритм, учитывающий отсутствие коммуникации между роботами в распределенных системах, за исключением обмена внутри связных компонент. Алгоритм группирует роботов в связные компоненты с помощью матрицы связей \( V \), проводит аукцион независимо в каждой компоненте и обеспечивает полную видимость целей. Доказана сходимость за конечное число шагов (теорема \ref{thm:mod_auction_convergence}) и оптимальность в каждой компоненте для целочисленных выгод \( \alpha_{ij} \) при \( \varepsilon < 1/n \) (теорема \ref{thm:mod_auction_optimality}), но глобальная оптимальность не достигается из-за отсутствия коммуникации между компонентами. Преимущества включают простоту реализации, снижение коммуникационных затрат и адаптивность к реальным сценариям робототехники. Сформулированные гипотезы задают направления для дальнейших исследований эффективности и устойчивости алгоритма.